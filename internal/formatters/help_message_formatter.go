package formatters

import (
	"evo-bot-go/internal/config"
	"evo-bot-go/internal/constants"
	"fmt"
)

// FormatHelpMessage generates the help message text with appropriate commands based on user permissions
func FormatHelpMessage(isAdmin bool, config *config.Config) string {
	helpText := "<b>üìã –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±–æ—Ç–∞</b>\n\n" +
		"<b>üè† –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã</b>\n" +
		"‚îî /start - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ\n" +
		"‚îî /help - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –º–æ–∏—Ö –∫–æ–º–∞–Ω–¥\n" +
		"‚îî /cancel - –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–º–µ–Ω—è–µ—Ç –ª—é–±–æ–π –¥–∏–∞–ª–æ–≥\n\n" +
		"<b>üë§ –ü—Ä–æ—Ñ–∏–ª—å</b>\n" +
		"‚îî /profile - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–∏–º –ø—Ä–æ—Ñ–∏–ª–µ–º, –ø–æ–∏—Å–∫ –ø—Ä–æ—Ñ–∏–ª–µ–π –∫–ª—É–±—á–∞–Ω, –ø—É–±–ª–∏–∫–∞—Ü–∏—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ–±–µ –≤ –∫–∞–Ω–∞–ª–µ ¬´–ò–Ω—Ç—Ä–æ¬ª\n\n" +
		"<b>üîç –ü–æ–∏—Å–∫</b>\n" +
		"‚îî /tools - –ù–∞–π—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏–∑ –∫–∞–Ω–∞–ª–∞ ¬´–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã¬ª\n" +
		"‚îî /content - –ù–∞–π—Ç–∏ –≤–∏–¥–µ–æ –∏–∑ –∫–∞–Ω–∞–ª–∞ ¬´–í–∏–¥–µ–æ-–∫–æ–Ω—Ç–µ–Ω—Ç¬ª\n" +
		"‚îî /intro - –ù–∞–π—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—á–∞—Å—Ç–Ω–∏–∫–∞—Ö –∫–ª—É–±–∞ –∏–∑ –∫–∞–Ω–∞–ª–∞ ¬´–ò–Ω—Ç—Ä–æ¬ª (—É–º–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –ø—Ä–æ—Ñ–∏–ª—è–º –∫–ª—É–±—á–∞–Ω)\n\n" +
		"<b>üìÖ –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</b>\n" +
		"‚îî /events - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π\n" +
		"‚îî /topics - –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–º—ã –∏ –≤–æ–ø—Ä–æ—Å—ã –∫ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º\n" +
		"‚îî /topicAdd - –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ç–µ–º—É –∏–ª–∏ –≤–æ–ø—Ä–æ—Å –∫ –ø—Ä–µ–¥—Å—Ç–æ—è—â–µ–º—É –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—é"

	featuresDescription := "\n\n<b>‚òïÔ∏è Random Coffee</b>\n" +
		"–Ø —Å–æ–∑–¥–∞—é –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ–ø—Ä–æ—Å—ã –¥–ª—è —É—á–∞—Å—Ç–∏—è –≤ –∫–ª—É–±–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á–∞—Ö. " +
		"–ò—Å–ø–æ–ª—å–∑—É–π –æ–ø—Ä–æ—Å, —á—Ç–æ–±—ã –ø–æ—É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Å–æ–∑–≤–æ–Ω–∞—Ö –∏ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –¥—Ä—É–≥–∏–º–∏ –∫–ª—É–±—á–∞–Ω–∞–º–∏. " +
		fmt.Sprintf("–ü–∞—Ä—ã –¥–ª—è —Å–æ–∑–≤–æ–Ω–æ–≤ –æ–±—ä—è–≤–ª—è—é—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ –Ω–µ–¥–µ–ª–∏ –≤ –∫–∞–Ω–∞–ª–µ <a href=\"https://t.me/c/%d/%d\">¬´Random Coffee¬ª</a>.",
			config.SuperGroupChatID, config.RandomCoffeeTopicID)

	helpText += featuresDescription

	helpText += "\n\n" + // Add some spacing before the link
		"<i>üí° <a href=\"https://t.me/c/2069889012/127/9470\">–û—Ç–∫—Ä—ã—Ç—å –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ</a></i>"

	if isAdmin {
		adminHelpText := "\n\n<b>üîê –ö–æ–º–∞–Ω–¥—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</b>\n" +
			fmt.Sprintf("‚îî /%s - –ù–∞—á–∞—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ\n", constants.EventStartCommand) +
			fmt.Sprintf("‚îî /%s - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ\n", constants.EventSetupCommand) +
			fmt.Sprintf("‚îî /%s - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ\n", constants.EventEditCommand) +
			fmt.Sprintf("‚îî /%s - –£–¥–∞–ª–∏—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ\n", constants.EventDeleteCommand) +
			fmt.Sprintf("‚îî /%s - –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–º—ã –∏ –≤–æ–ø—Ä–æ—Å—ã –∫ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º <b>—Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω–∏—è</b>\n", constants.ShowTopicsCommand) +
			fmt.Sprintf("‚îî /%s - –í–≤–µ—Å—Ç–∏ –∫–æ–¥ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ TG-–∫–ª–∏–µ–Ω—Ç–∞ (–∑–∞–¥–æ–º –Ω–∞–ø–µ—Ä–µ–¥)\n", constants.CodeCommand) +
			fmt.Sprintf("‚îî /%s - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è–º–∏ –∫–ª—É–±—á–∞–Ω", constants.AdminProfilesCommand)

		testCommandsHelpText := "\n\n<b>‚öôÔ∏è –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</b>\n" +
			fmt.Sprintf("‚îî /%s - –†—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –æ–±—â–µ–Ω–∏—è –≤ –∫–ª—É–±–µ\n", constants.TrySummarizeCommand) +
			fmt.Sprintf("‚îî /%s - –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–ø—Ä–æ—Å–∞ –ø–æ Random Coffee\n", constants.TryCreateCoffeePoolCommand) +
			fmt.Sprintf("‚îî /%s - –†—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä –¥–ª—è Random Coffee\n", constants.TryGenerateCoffeePairsCommand) +
			fmt.Sprintf("‚îî /%s - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –±–∞–∑—É –∑–Ω–∞–Ω–∏–π –≤ –õ–°\n", constants.TryLinkToLearnCommand)

		helpText += adminHelpText
		helpText += testCommandsHelpText
	}

	return helpText
}
